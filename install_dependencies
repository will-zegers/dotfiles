#! /usr/bin/env bash

set -ex

PACKAGES="
  curl
  exuberant-ctags
  git
  luarocks
  ripgrep
  tmux
  tree
  vim
  wget
  xclip
  zsh
"

apt update
apt install -y ${PACKAGES}

### Grab the latest stable release of Neovim ###
arch=$(uname -m)
if [[ "$arch" == "x86_64" ]]; then
    PKG_NAME="nvim-linux-x86_64"
elif [[ "$arch" == "aarch64" ]]; then
    PKG_NAME="nvim-linux-arm64"
fi

ARCHIVE=${PKG_NAME}.tar.gz
wget https://github.com/neovim/neovim/releases/latest/download/${ARCHIVE} -P /tmp
tar xzf /tmp/${ARCHIVE} -C /usr/local/

ln -sf /usr/local/${PKG_NAME}/bin/nvim /etc/alternatives/nvim
ln -sf /etc/alternatives/nvim /usr/bin/vi
ln -sf /etc/alternatives/nvim /usr/bin/nvim
###

SCRIPT_DIR="$( cd "$(dirname "$0")" >/dev/null 2>&1 ; pwd -P )"
if [! command -v alacritty ]; then
  ${SCRIPT_DIR}/alacritty/install
fi

touch /tmp/install_dependencies.stamp
